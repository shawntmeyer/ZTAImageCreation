{
    "$schema": "https://schema.management.azure.com/schemas/2021-09-09/uiFormDefinition.schema.json",
    "view": {
        "kind": "Form",
        "properties": {
            "title": "Custom Image Build",
            "steps": [
                {
                    "name": "basics",
                    "label": "Deployment Basics",
                    "elements": [
						{
							"name": "infoPreReq",
							"type": "Microsoft.Common.InfoBox",
							"visible": true,
							"options": {
								"style": "Warning",
								"text": "PREREQUISITES REQUIRED \n\nThere are prerequisites that must be setup in your Azure environment to successfully deploy this Custom Image Build. Click here to review the prerequisites in the Getting Started guide.",
								"uri": "https://www.microsoft.com"
							}
						},
						{
                            "name": "scope",
                            "type": "Microsoft.Common.ResourceScope",
							"instanceDetailsLabel": "Image Build Resources",
                            "location": {
								"label": "Region where Virtual Machines are created",
                                "resourceTypes": ["Microsoft.Compute/virtualmachines"]
                            }
                        },
						{
							"name": "deploymentSpecs",
							"type":"Microsoft.Common.Section",
							"visible": true,
							"label": "Deployment Specifications",
							"elements":[
								{
									"name": "deploymentPrefix",
									"type": "Microsoft.Common.TextBox",
									"label": "Deployment Prefix",
									"subLabel": "",
									"placeholder": "imgbld",
									"toolTip": "Provide a prefix (from 2 to 6 characters) for the deployments created by this template.",
									"constraints": {
										"required": true,
										"regex": "^[a-z0-9A-Z-]{2,6}$",
										"validationMessage": "The prefix must be between 2 and 6 characters"
										]
									}
                        		},                       
								{
									"name": "envClassification",
									"type": "Microsoft.Common.DropDown",
									"label": "Env Classification",
									"infoMessages": [
										{
											"style": "information",
											"text": "Select the type of environment (Development (Dev), Test (Test), Production (Prod)) for which this solution is being deployed. This information will be use as part of the resources naming. Select '<Not Specified>' to omit this option."
										}
									],
									"defaultValue": "<Not Specified>",
									"toolTip": "Select the type of environment (Development (Dev), Test (Test), Production (Prod)) for which this solution is being deployed. This information will be use as part of the resources naming. Select (or leave the value as) '<Not Specified>' to omit this option.",
									"constraints": {
										"required": false,
										"allowedValues": [
											{
												"label": "",
												"value": "<Not Specified>"
											}
											{
												"label": "Development",
												"value": "Dev"
											},
											{
												"label": "Test",
												"value": "Test"
											},
											{
												"label": "Production",
												"value": "Prod"
											}
										]
									}
								}
							]
						}
					]
				},
				{
					"name": "prereqs",
					"label": "Imaging Prerequisites and Resources",
					"elements": [
						{
							"name": "infoPreReq",
							"type": "Microsoft.Common.InfoBox",
							"options": {
								"style":"Warning",
								"text": "Prior to deployment, make sure you meet the prerequisites outlined in the resource pre-reqs section in Zero Trust Image solution documentation:",
								"uri": "https://github.com/mikedzikowski/ZTAImage#prequisites"
							}
						},
						{
							"name": "storage",
							"type": "Microsoft.Common.Section",
							"label": "Storage Account",
							"elements": [
								{
									"name": "storageSelector",
									"type": "Microsoft.Solutions.ResourceSelector",
									"label": "Select image assets storage account",
									"resourceType": "Microsoft.Storage/storageAccounts"
								},
								{
									"name": "containerApi",
									"type": "Microsoft.Solutions.ArmApiControl",
									"request": {
										"method": "GET",
										"path": "[concat(steps('prereqs').storage.storageSelector.id, '/blobServices/default/containers?api-version=2023-01-01')]"
									}
								},
								{
									"name": "container",
									"type": "Microsoft.Common.DropDown",
									"visible": true,
									"label": "Container",
									"defaultValue": "",
									"toolTip": "Select an existing container.",
									"constraints": {
										"required": true,
										"allowedValues": "[map(steps('prereqs').storage.containerApi.value, (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.id, '\"}')))]"
									}
								},
								{
									"name": "managedIdentity",
									"type": "Microsoft.Solutions.ResourceSelector",
									"label": "Select user assigned identity with at least 'Storage Blob Data Reader Rights' to the storage account and container selected above.",
									"resourceType": "Microsoft.ManagedIdentity/userAssignedIdentities",
									"constraints": {
										"required": true
									}
								}
							]
						},
						{
							"name": "network",
							"type": "Microsoft.Common.Section",
							"label": "Networking",
							"elements": [
								{
									"name": "virtualNetworksApi",
									"type": "Microsoft.Solutions.ArmApiControl",
									"request": {
										"method": "GET",
										"path": "[concat(steps('basics').scope.subscription.id, '/providers/Microsoft.Network/virtualNetworks?api-version=2022-11-01')]"
									}
								},
								{
									"name": "virtualNetwork",
									"type": "Microsoft.Common.DropDown",
									"visible": true,
									"label": "Virtual Network",
									"defaultValue": "",
									"toolTip": "Select an existing virtual network for image capture. If the desired network isn't available be sure to change the region in the Deployment Details section above.",
									"constraints": {
										"required": true,
										"allowedValues": "[map(filter(steps('prereqs').network.virtualNetworksApi.value, (item) => equals(item.location, steps('basics').scope.location.name)), (item) => parse(concat('{\"label\":\"', item.name, '\",\"description\":\"Resource group: ', first(skip(split(item.id, '/'), 4)), '\",\"value\":\"', item.id, '\"}')))]"
									}
								},
								{
									"name": "subnetsApi",
									"type": "Microsoft.Solutions.ArmApiControl",
									"request": {
										"method": "GET",
										"path": "[concat(steps('prereqs').network.virtualNetwork, '/subnets?api-version=2022-05-01')]"
									}
								},
								{
									"name": "subnet",
									"type": "Microsoft.Common.DropDown",
									"visible": true,
									"label": "Subnet",
									"defaultValue": "",
									"toolTip": "Select an existing subnet for the image capture.",
									"constraints": {
										"required": true,
										"allowedValues": "[map(steps('prereqs').network.subnetsApi.value, (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.id, '\"}')))]"
									}
								}
							]
						},
						{
							"name": "gallery",
							"type": "Microsoft.Common.Section",
							"label": "Azure Compute Gallery",
							"elements": [
								{
									"name": "gallery",
									"type": "Microsoft.Solutions.ResourceSelector",
									"label": "Select the existing Compute Gallery",
									"resourceType": "Microsoft.Compute/galleries"
								}
							]
						}				
					]
				},
				{
					"name": "imageVm",
					"label": "Image Virtual Machine",
					"elements": [
						{
							"name": "resGroup",
							"type": "Microsoft.Common.Section",
							"label": "Resource Group",
							"elements": [
								{
									"name": "useExResGroup",
									"type": "Microsoft.Common.OptionsGroup",
									"label": "Use Existing Resource Group",
									"defaultValue": "yes",
									"toolTip": "",
									"constraints": {
										"allowedValues": [
											{
												"label": "Yes",
												"value": "yes"
											},
											{
												"label": "No",
												"value": "no"
											}
										],
										"required": true
									}
								},
								{
                                    "name": "resourceGroupsApi",
                                    "type": "Microsoft.Solutions.ArmApiControl",
                                    "request": {
                                        "method": "GET",
                                        "path": "[concat(steps('basics').scope.subscription.id, '/resourceGroups?api-version=2021-04-01')]"
                                    }
                                },
                                {
                                    "name": "resourceGroup",
                                    "type": "Microsoft.Common.DropDown",
                                    "label": "Deployment Resource Group",
                                    "multiselect": false,
                                    "defaultValue": "",
                                    "toolTip": "Select the name of the existing resource group where the image build virtual machines and associated resources will be created.",
                                    "filterPlaceholder": "",
                                    "defaultDescription": "",
                                    "constraints": {
                                        "allowedValues": "[map(steps('imageVm').resGroup.ResourceGroupsApi.value, (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                                        "required": true
                                    },
                                    "visible": "[equals(steps('imageVm').resGroup.useExResGroup, 'yes')]"
                                },
								{
									"name": "customBuildResourceGroupName",
									"type": "Microsoft.Common.TextBox",
									"label": "Custom Build Resource Group Name",
									"subLabel": "Leave blank if you want to allow this deployment to create a resource group automatically named with CAF principals.",
									"placeholder": "rg-image-build-resources-<environment>-<location>",
									"toolTip": "The custom name of the resource group where the image build and management vms will be created.",
									"constraints": {
										"required": false,
										"regex": "^[a-z0-9A-Z-]{2,90}$",
										"validationMessage": "If provided the value must be between 2 and 90 characters."
									},
									"visible": "[equals(steps('imageVm').resGroup.useExResGroup, 'no')]"
								}
							]
						},
						{
							"name": "vmProps",
							"type": "Microsoft.Common.Section",
							"label": "Virtual Machine Properties",
							"elements": [
                        		{
                                    "name": "vmSize",
                                    "type": "Microsoft.Compute.SizeSelector",
                                    "label": "VM Size",
                                    "toolTip": "",
                                    "recommendedSizes": [
                                        "Standard_D4ads_v5"
                                    ],
                                    "osPlatform": "Windows"
								},
								{
                                    "name": "osVersion",
                                    "type": "Microsoft.Common.DropDown",
                                    "label": "Operating System Version",
                                    "filter": true,
                                    "defaultValue": "Windows 11 22H2 (Gen2)",
                                    "toolTip": "Select the operating system version for the source image.",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "Windows 10 21H2 (Gen1)",
                                                "value": "win10_21h2"
                                            },
                                            {
                                                "label": "Windows 10 21H2 - Office 365 (Gen1)",
                                                "value": "win10_21h2_office"
                                            },
                                            {
                                                "label": "Windows 10 22H2 (Gen2)",
                                                "value": "win10_22h2_g2"
                                            },
                                            {
                                                "label": "Windows 10 22H2 - Office 365 (Gen2)",
                                                "value": "win10_22h2_office_g2"
                                            },
                                            {
                                                "label": "Windows 11 21H2 (Gen2)",
                                                "value": "win11_21h2"
                                            },
                                            {
                                                "label": "Windows 11 21H2 - Office 365 (Gen2)",
                                                "value": "win11_21h2_office"
                                            },
                                            {
                                                "label": "Windows 11 22H2 (Gen2)",
                                                "value": "win11_22h2"
                                            },
                                            {
                                                "label": "Windows 11 22H2 - Office 365 (Gen2)",
                                                "value": "win11_22h2_office"
                                            }
                                        ]
                                    }
                                },
								{
                                    "name": "vmSecurityTypeWarning",
                                    "type": "Microsoft.Common.InfoBox",
                                    "options": {
                                        "text": "Setting the Security Type to anything other than 'Standard' requires that the Azure Compute Gallery Image Definition be configured with the Security Type feature set to the appropriate value. You can determine if the image definition supports the required feature by reviewing the 'Properties' tab on the 'Overview' node of the Gallery Image Definition in the portal. If the image definition does not contain these feature options, then the deployment will fail.",
                                        "uri": "https://learn.microsoft.com/azure/templates/microsoft.compute/galleries/images?pivots=deployment-language-bicep",
                                        "style": "Warning"
                                    },
									"visible": "[or(contains(steps('imageVM').vmProps.osVersion, 'g2'), contains(steps('imageVM').vmProps.osVersion, 'win11'))]"
                                },
                                {
                                    "name": "securityType",
                                    "type": "Microsoft.Common.DropDown",
                                    "label": "Security type",
                                    "filter": true,
                                    "defaultValue": "Trusted Launch Virtual Machines",
                                    "toolTip": "Choose a type of security that matches your needs: Standard includes basic protections at no additional cost. Trusted launch virtual machines provide additional security features on Gen2 virtual machines to protect against persistent and advanced attacks.",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "Standard",
                                                "value": "Standard"
                                            },
                                            {
                                                "label": "Trusted Launch Virtual Machines",
                                                "value": "TrustedLaunch"
                                            },
                                            {
                                                "label": "Confidential Virtual Machines",
                                                "value": "ConfidentialVM"
                                            }
                                        ]
                                    }
                                }
							],
							"visible": "[or(contains(steps('imageVM').vmProps.osVersion, 'g2'), contains(steps('imageVM').vmProps.osVersion, 'win11'))]"
						}						
					]
				},
				{
					"name": "imageDest",
					"label": "Image Distribution Options",
					"elements": [
						{
							"name": "info",
							"type": "Microsoft.Common.TextBlock",
							"visible": true,
							"options": {
								"text": "For image management, this solution will create a new image version of a image (definition) in the Azure Compute Gallery selected on the Basics tab. You have the option to use an existing image definiton or define a new one.",
								"link": {
									"label": "Learn more about managing images with an Azure Compute Gallery.",
									"uri": "https://learn.microsoft.com/en-us/azure/virtual-machines/windows/image-builder-gallery"
								}
							}
						},
						{
							"name": "imageDefinition",
							"type": "Microsoft.Common.Section",
							"visible": true,
							"label": "Image Definition Details",
							"elements": [{
									"name": "useExImageDef",
									"type": "Microsoft.Common.OptionsGroup",
									"label": "Use Existing Image Definition",
									"defaultValue": "yes",
									"toolTip": "Determines if you want to use an existing image definition from the Azure Compute Gallery selected on the 'Prerequisites' page or create a new one.",
									"constraints": {
										"allowedValues": [
											{
												"label": "Yes",
												"value": "yes"
											},
											{
												"label": "No",
												"value": "no"
											}
										],
										"required": true
									},
									"visible": true
								},
								{
                                    "name": "imagesApi",
                                    "type": "Microsoft.Solutions.ArmApiControl",
                                    "request": {
                                        "method": "GET",
                                        "path": "[concat(steps('prereqs').gallery.gallery.id, '/images?api-version=2021-04-01')]"
                                    }
                                },
                                {
                                    "name": "imageDefinition",
                                    "type": "Microsoft.Common.DropDown",
                                    "label": "Deployment Resource Group",
                                    "multiselect": false,
                                    "defaultValue": "",
                                    "toolTip": "Select the existing image definition for which a new image version will be selected. If the desired image definition is not available, check your Compute Gallery selection on the 'Prerequisites' page or select to create a new one above.",
                                    "filterPlaceholder": "",
                                    "defaultDescription": "",
                                    "constraints": {
                                        "allowedValues": "[map(steps('imageDest').imageDefinition.imagesApi.value, (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                                        "required": true
                                    },
                                    "visible": "[equals(steps('imageDest').imageDefinition.useExImageDef, 'yes')]"
                                },
								{
									"name": "customImageDefinitionName",
									"type": "Microsoft.Common.TextBox",
									"label": "Custom Image Definition Name",
									"subLabel": "Leave blank if you want to allow this deployment to create an image definition in the Image Gallery chosen on the 'Prerequisites' page with a name based on the selections below.",
									"placeholder": "vmid-<imagePublisher>-<imageOffer>-<imageSku>-<environment>-<location>",
									"toolTip": "The name of the image definition to create in the Image Gallery. Leave blank if you want to allow this deployment to create an image definition in the Image Gallery chosen on the 'Prerequisites' page with a name based on the selections below.",
									"constraints": {
										"required": false,
										"regex": "^[a-z0-9A-Z-]{2,90}$",
										"validationMessage": "When provided, the name must be between 2 and 90 characters long and only use valid characters."
									},
									"visible": "[equals(steps('imageDest').imageDefinition.useExImageDef, 'no')]"
								},
								{
									"name": "imageDefinitionPublisher",
									"type": "Microsoft.Common.TextBox",
									"label": "Image Definition Publisher",
									"subLabel": "",
									"defaultValue": "",
									"toolTip": "The compute gallery image definition Publisher.",
									"constraints": {
										"required": true,
										"regex": "^[a-z0-9A-Z-]{2,20}$",
										"validationMessage": "The value must contain only valid characters and be between 2 and 20 characters in length."
									},
									"visible": "[equals(steps('imageDest').imageDefinition.useExImageDef, 'no')]"
								},
								{
									"name": "imageDefinitionOffer",
									"type": "Microsoft.Common.TextBox",
									"label": "Image Definition Offer",
									"subLabel": "",
									"defaultValue": "",
									"toolTip": "The compute gallery image definition Offer.",
									"constraints": {
										"required": true,
										"regex": "^[a-z0-9A-Z-]{2,20}$",
										"validationMessage": "The value must contain only valid characters and be between 2 and 20 characters in length."
									},
									"visible": "[equals(steps('imageDest').imageDefinition.useExImageDef, 'no')]"
								},                        
								{
									"name": "imageDefinitionSku",
									"type": "Microsoft.Common.TextBox",
									"label": "Image Definition Sku",
									"subLabel": "",
									"defaultValue": "",
									"toolTip": "The compute gallery image definition Sku.",
									"constraints": {
										"required": true,
										"regex": "^[a-z0-9A-Z-]{2,20}$",
										"validationMessage": "The value must contain only valid characters and be between 2 and 20 characters in length."
									},
									"visible": "[equals(steps('imageDest').imageDefinition.useExImageDef, 'no')]"
								}
							]
						
						},
						{
							"name": "imageVersion",
							"type": "Microsoft.Common.Section",
							"label": "Image Version Details",
							"elements": [
								{
									"name": "useCustomVersion",
									"type": "Microsoft.Common.OptionsGroup",
									"label": "Specify Custom Version Information",
									"defaultValue": "no",
									"toolTip": "Select 'Yes' to specify the Major.Minor.Patch version information or 'No' to generate the Image Version based on the Date and Time (i.e., yy.MMdd.mmss).",
									"constraints": {
										"allowedValues": [
											{
												"label": "Yes",
												"value": "yes"
											},
											{
												"label": "No",
												"value": "no"
											}
										],
										"required": true
									}
								},
								{
									"name": "imageMajorVersion",
									"type": "Microsoft.Common.TextBox",
									"label": "Image Major Version",
									"subLabel": "",
									"defaultValue": "0",
									"toolTip": "",
									"constraints": {
										"required": true,
										"regex": "^[0-9]{2,4}$",
										"validationMessage": "Each portion of the version should contain between 2 and 4 numbers."
									},
									"visible": "[equals(steps('imageDest').imageVersion.useCustomVersion, 'no')]"
								},
								{
									"name": "imageMinorVersion",
									"type": "Microsoft.Common.TextBox",
									"label": "Image Minor Version",
									"subLabel": "",
									"defaultValue": "0",
									"toolTip": "",
									"constraints": {
										"required": true,
										"regex": "^[0-9]{2,4}$",
										"validationMessage": "Each portion of the version should contain between 2 and 4 numbers."
									},
									"visible": "[equals(steps('imageDest').imageVersion.useCustomVersion, 'no')]"
								},
								{
									"name": "imagePatch",
									"type": "Microsoft.Common.TextBox",
									"label": "Image Patch",
									"subLabel": "",
									"defaultValue": "0",
									"toolTip": "",
									"constraints": {
										"required": true,
										"regex": "^[0-9]{2,4}$",
										"validationMessage": "Each portion of the version should contain between 2 and 4 numbers."
									},
									"visible": "[equals(steps('imageDest').imageVersion.useCustomVersion, 'no')]"
								},
								{
									"name": "imageVersionExcludeFromLatest",
									"type": "Microsoft.Common.DropDown",
									"label": "Image Version Exclude From Latest",
									"defaultValue": "false",
									"toolTip": "Exclude the image version created by this process from the latest version for the image definition.",
									"constraints": {
										"allowedValues": [
											{
												"label": "true",
												"value": true
											},
											{
												"label": "false",
												"value": false
											}
										],
										"required": true
									}
                                },
                            "infoMessages": [],
                            "visible": true
                        },
                        {
                            "name": "imageVersionEOLinDays",
                            "type": "Microsoft.Common.TextBox",
                            "label": "Image Version EO Lin Days",
                            "subLabel": "",
                            "defaultValue": "0",
                            "toolTip": "Optional. The number of days from now that the image version will reach end of life.",
                            "constraints": {
                                "required": false,
                                "regex": "",
                                "validationMessage": "",
                                "validations": []
                            },
                            "infoMessages": [],
                            "visible": true
                        },
                        {
                            "name": "replicationRegions",
                            "type": "Microsoft.Common.TextBox",
                            "label": "Replication Regions",
                            "subLabel": "",
                            "defaultValue": "[[]",
                            "toolTip": "Optional. The regions to which the image version will be replicated in addition to the location of the deployment.",
                            "constraints": {
                                "required": false,
                                "regex": "",
                                "validationMessage": "",
                                "validations": []
                            },
                            "infoMessages": [],
                            "visible": true
                        },
                        {
                            "name": "replicaCount",
                            "type": "Microsoft.Common.TextBox",
                            "label": "Replica Count",
                            "subLabel": "",
                            "defaultValue": "",
                            "toolTip": "The number of replicas in the primary region of the image version.",
                            "constraints": {
                                "required": true,
                                "regex": "",
                                "validationMessage": "",
                                "validations": []
                            },
                            "infoMessages": [],
                            "visible": true
                        },
							]
						}

				}

			]

		},
                        


                        {
                            "name": "tenantType",
                            "type": "Microsoft.Common.DropDown",
                            "label": "Tenant Type",
                            "subLabel": "",
                            "defaultValue": " ",
                            "toolTip": "Used to select the correct version of certain office components to install.",
                            "constraints": {
                                "required": true,
                                "allowedValues": [
                                    {
                                        "label": "Commercial",
                                        "value": "Commercial"
                                    },
                                    {
                                        "label": "DepartmentOfDefense",
                                        "value": "DepartmentOfDefense"
                                    },
                                    {
                                        "label": "GovernmentCommunityCloud",
                                        "value": "GovernmentCommunityCloud"
                                    },
                                    {
                                        "label": "GovernmentCommunityCloudHigh",
                                        "value": "GovernmentCommunityCloudHigh"
                                    }
                                ],
                                "validations": []
                            },
                            "infoMessages": [],
                            "visible": true
                        },
                        {
                            "name": "installAccess",
                            "type": "Microsoft.Common.DropDown",
                            "label": "Install Access",
                            "subLabel": "",
                            "defaultValue": " ",
                            "toolTip": "",
                            "constraints": {
                                "required": true,
                                "allowedValues": [
                                    {
                                        "label": "true",
                                        "value": true
                                    },
                                    {
                                        "label": "false",
                                        "value": false
                                    }
                                ],
                                "validations": []
                            },
                            "infoMessages": [],
                            "visible": true
                        },
                        {
                            "name": "installExcel",
                            "type": "Microsoft.Common.DropDown",
                            "label": "Install Excel",
                            "subLabel": "",
                            "defaultValue": " ",
                            "toolTip": "",
                            "constraints": {
                                "required": true,
                                "allowedValues": [
                                    {
                                        "label": "true",
                                        "value": true
                                    },
                                    {
                                        "label": "false",
                                        "value": false
                                    }
                                ],
                                "validations": []
                            },
                            "infoMessages": [],
                            "visible": true
                        },
                        {
                            "name": "installOneDriveForBusiness",
                            "type": "Microsoft.Common.DropDown",
                            "label": "Install One Drive For Business",
                            "subLabel": "",
                            "defaultValue": " ",
                            "toolTip": "",
                            "constraints": {
                                "required": true,
                                "allowedValues": [
                                    {
                                        "label": "true",
                                        "value": true
                                    },
                                    {
                                        "label": "false",
                                        "value": false
                                    }
                                ],
                                "validations": []
                            },
                            "infoMessages": [],
                            "visible": true
                        },
                        {
                            "name": "installOneNote",
                            "type": "Microsoft.Common.DropDown",
                            "label": "Install One Note",
                            "subLabel": "",
                            "defaultValue": " ",
                            "toolTip": "",
                            "constraints": {
                                "required": true,
                                "allowedValues": [
                                    {
                                        "label": "true",
                                        "value": true
                                    },
                                    {
                                        "label": "false",
                                        "value": false
                                    }
                                ],
                                "validations": []
                            },
                            "infoMessages": [],
                            "visible": true
                        },
                        {
                            "name": "installOutlook",
                            "type": "Microsoft.Common.DropDown",
                            "label": "Install Outlook",
                            "subLabel": "",
                            "defaultValue": " ",
                            "toolTip": "",
                            "constraints": {
                                "required": true,
                                "allowedValues": [
                                    {
                                        "label": "true",
                                        "value": true
                                    },
                                    {
                                        "label": "false",
                                        "value": false
                                    }
                                ],
                                "validations": []
                            },
                            "infoMessages": [],
                            "visible": true
                        },
                        {
                            "name": "installPowerPoint",
                            "type": "Microsoft.Common.DropDown",
                            "label": "Install Power Point",
                            "subLabel": "",
                            "defaultValue": " ",
                            "toolTip": "",
                            "constraints": {
                                "required": true,
                                "allowedValues": [
                                    {
                                        "label": "true",
                                        "value": true
                                    },
                                    {
                                        "label": "false",
                                        "value": false
                                    }
                                ],
                                "validations": []
                            },
                            "infoMessages": [],
                            "visible": true
                        },
                        {
                            "name": "installProject",
                            "type": "Microsoft.Common.DropDown",
                            "label": "Install Project",
                            "subLabel": "",
                            "defaultValue": " ",
                            "toolTip": "",
                            "constraints": {
                                "required": true,
                                "allowedValues": [
                                    {
                                        "label": "true",
                                        "value": true
                                    },
                                    {
                                        "label": "false",
                                        "value": false
                                    }
                                ],
                                "validations": []
                            },
                            "infoMessages": [],
                            "visible": true
                        },
                        {
                            "name": "installpublisher",
                            "type": "Microsoft.Common.DropDown",
                            "label": "Installpublisher",
                            "subLabel": "",
                            "defaultValue": " ",
                            "toolTip": "",
                            "constraints": {
                                "required": true,
                                "allowedValues": [
                                    {
                                        "label": "true",
                                        "value": true
                                    },
                                    {
                                        "label": "false",
                                        "value": false
                                    }
                                ],
                                "validations": []
                            },
                            "infoMessages": [],
                            "visible": true
                        },
                        {
                            "name": "installSkypeForBusiness",
                            "type": "Microsoft.Common.DropDown",
                            "label": "Install Skype For Business",
                            "subLabel": "",
                            "defaultValue": " ",
                            "toolTip": "",
                            "constraints": {
                                "required": true,
                                "allowedValues": [
                                    {
                                        "label": "true",
                                        "value": true
                                    },
                                    {
                                        "label": "false",
                                        "value": false
                                    }
                                ],
                                "validations": []
                            },
                            "infoMessages": [],
                            "visible": true
                        },
                        {
                            "name": "installTeams",
                            "type": "Microsoft.Common.DropDown",
                            "label": "Install Teams",
                            "subLabel": "",
                            "defaultValue": " ",
                            "toolTip": "",
                            "constraints": {
                                "required": true,
                                "allowedValues": [
                                    {
                                        "label": "true",
                                        "value": true
                                    },
                                    {
                                        "label": "false",
                                        "value": false
                                    }
                                ],
                                "validations": []
                            },
                            "infoMessages": [],
                            "visible": true
                        },
                        {
                            "name": "installVirtualDesktopOptimizationTool",
                            "type": "Microsoft.Common.DropDown",
                            "label": "Install Virtual Desktop Optimization Tool",
                            "subLabel": "",
                            "defaultValue": " ",
                            "toolTip": "",
                            "constraints": {
                                "required": true,
                                "allowedValues": [
                                    {
                                        "label": "true",
                                        "value": true
                                    },
                                    {
                                        "label": "false",
                                        "value": false
                                    }
                                ],
                                "validations": []
                            },
                            "infoMessages": [],
                            "visible": true
                        },
                        {
                            "name": "installVisio",
                            "type": "Microsoft.Common.DropDown",
                            "label": "Install Visio",
                            "subLabel": "",
                            "defaultValue": " ",
                            "toolTip": "",
                            "constraints": {
                                "required": true,
                                "allowedValues": [
                                    {
                                        "label": "true",
                                        "value": true
                                    },
                                    {
                                        "label": "false",
                                        "value": false
                                    }
                                ],
                                "validations": []
                            },
                            "infoMessages": [],
                            "visible": true
                        },
                        {
                            "name": "installWord",
                            "type": "Microsoft.Common.DropDown",
                            "label": "Install Word",
                            "subLabel": "",
                            "defaultValue": " ",
                            "toolTip": "",
                            "constraints": {
                                "required": true,
                                "allowedValues": [
                                    {
                                        "label": "true",
                                        "value": true
                                    },
                                    {
                                        "label": "false",
                                        "value": false
                                    }
                                ],
                                "validations": []
                            },
                            "infoMessages": [],
                            "visible": true
                        },
                        {
                            "name": "vDotInstaller",
                            "type": "Microsoft.Common.TextBox",
                            "label": "V Dot Installer",
                            "subLabel": "",
                            "defaultValue": "",
                            "toolTip": "",
                            "constraints": {
                                "required": true,
                                "regex": "",
                                "validationMessage": "",
                                "validations": []
                            },
                            "infoMessages": [],
                            "visible": true
                        },
                        {
                            "name": "officeInstaller",
                            "type": "Microsoft.Common.TextBox",
                            "label": "Office Installer",
                            "subLabel": "",
                            "defaultValue": "Office365-Install.zip",
                            "toolTip": "",
                            "constraints": {
                                "required": false,
                                "regex": "",
                                "validationMessage": "",
                                "validations": []
                            },
                            "infoMessages": [],
                            "visible": true
                        },
                        {
                            "name": "teamsInstaller",
                            "type": "Microsoft.Common.TextBox",
                            "label": "Teams Installer",
                            "subLabel": "",
                            "defaultValue": "",
                            "toolTip": "",
                            "constraints": {
                                "required": true,
                                "regex": "",
                                "validationMessage": "",
                                "validations": []
                            },
                            "infoMessages": [],
                            "visible": true
                        },
                        {
                            "name": "msrdcwebrtcsvcInstaller",
                            "type": "Microsoft.Common.TextBox",
                            "label": "Msrdcwebrtcsvc Installer",
                            "subLabel": "",
                            "defaultValue": "",
                            "toolTip": "",
                            "constraints": {
                                "required": true,
                                "regex": "",
                                "validationMessage": "",
                                "validations": []
                            },
                            "infoMessages": [],
                            "visible": true
                        },
                        {
                            "name": "vcRedistInstaller",
                            "type": "Microsoft.Common.TextBox",
                            "label": "Vc Redist Installer",
                            "subLabel": "",
                            "defaultValue": "",
                            "toolTip": "",
                            "constraints": {
                                "required": true,
                                "regex": "",
                                "validationMessage": "",
                                "validations": []
                            },
                            "infoMessages": [],
                            "visible": true
                        },
                        {
                            "name": "customizations",
                            "type": "Microsoft.Common.TextBox",
                            "label": "Customizations",
                            "subLabel": "",
                            "defaultValue": "[[]",
                            "toolTip": "An array of image customizations consisting of the blob name and parameters.\r\nBICEP example:\r\n[\r\n  {\r\n    name: 'FSLogix'\r\n    blobName: 'Install-FSLogix.zip'\r\n    arguments: 'latest'\r\n  }\r\n  {\r\n    name: 'VSCode'\r\n    blobName: 'VSCode.zip'\r\n    arguments: ''\r\n  }\r\n]\r\n",
                            "constraints": {
                                "required": false,
                                "regex": "",
                                "validationMessage": "",
                                "validations": []
                            },
                            "infoMessages": [],
                            "visible": true
                        },
                        
                        
                        
                        {
                            "name": "hyperVGeneration",
                            "type": "Microsoft.Common.DropDown",
                            "label": "Hyper V Generation",
                            "subLabel": "",
                            "defaultValue": "V2",
                            "toolTip": "Optional. The Hyper-V generation of the image definition. (Default = \"V2\")",
                            "constraints": {
                                "required": false,
                                "allowedValues": [
                                    {
                                        "label": "V1",
                                        "value": "V1"
                                    },
                                    {
                                        "label": "V2",
                                        "value": "V2"
                                    }
                                ],
                                "validations": []
                            },
                            "infoMessages": [],
                            "visible": true
                        }
                    ]
                }
            ]
        },
        "outputs": {
            "kind": "Subscription",
            "location": "[steps('basics').scope.location.name]",
            "subscriptionId": "[steps('basics').scope.subscription.id]",
            "parameters": {
				"deploymentLocation": "[steps('basics').scope.location.name]",
                "deploymentPrefix": "[steps('basics').deploymentSpecs.deploymentPrefix]",
                "envClassification": "[steps('basics').deploymentSpecs.envClassification]",
                "computeGalleryResourceId": "[steps('basics').computeGalleryResourceId]",
                "storageAcountResourceId": "[steps('basics').storageAcountResourceId]",
                "containerName": "[steps('basics').containerName]",
                "subnetResourceId": "[steps('basics').subnetResourceId]",
                "userAssignedIdentityResourceId": "[steps('basics').userAssignedIdentityResourceId]",
                "customBuildResourceGroupName": "[steps('basics').customBuildResourceGroupName]",
                "offer": "[steps('basics').offer]",
                "publisher": "[steps('basics').publisher]",
                "sku": "[steps('basics').sku]",
                "vmSize": "[steps('basics').vmSize]",
                "tenantType": "[steps('basics').tenantType]",
                "installAccess": "[steps('basics').installAccess]",
                "installExcel": "[steps('basics').installExcel]",
                "installOneDriveForBusiness": "[steps('basics').installOneDriveForBusiness]",
                "installOneNote": "[steps('basics').installOneNote]",
                "installOutlook": "[steps('basics').installOutlook]",
                "installPowerPoint": "[steps('basics').installPowerPoint]",
                "installProject": "[steps('basics').installProject]",
                "installpublisher": "[steps('basics').installpublisher]",
                "installSkypeForBusiness": "[steps('basics').installSkypeForBusiness]",
                "installTeams": "[steps('basics').installTeams]",
                "installVirtualDesktopOptimizationTool": "[steps('basics').installVirtualDesktopOptimizationTool]",
                "installVisio": "[steps('basics').installVisio]",
                "installWord": "[steps('basics').installWord]",
                "vDotInstaller": "[steps('basics').vDotInstaller]",
                "officeInstaller": "[steps('basics').officeInstaller]",
                "teamsInstaller": "[steps('basics').teamsInstaller]",
                "msrdcwebrtcsvcInstaller": "[steps('basics').msrdcwebrtcsvcInstaller]",
                "vcRedistInstaller": "[steps('basics').vcRedistInstaller]",
                "customizations": "[steps('basics').customizations]",
                "imageDefinitionResourceId": "[steps('basics').imageDefinitionResourceId]",
                "customImageDefinitionName": "[steps('basics').customImageDefinitionName]",
                "imageDefinitionOffer": "[steps('basics').imageDefinitionOffer]",
                "imageDefinitionPublisher": "[steps('basics').imageDefinitionPublisher]",
                "imageDefinitionSku": "[steps('basics').imageDefinitionSku]",
                "imageVersionExcludeFromLatest": "[steps('basics').imageVersionExcludeFromLatest]",
                "imageVersionEOLinDays": "[steps('basics').imageVersionEOLinDays]",
                "replicationRegions": "[steps('basics').replicationRegions]",
                "replicaCount": "[steps('basics').replicaCount]",
                "securityType": "[steps('basics').securityType]",
                "imageMajorVersion": "[steps('basics').imageMajorVersion]",
                "imageMinorVersion": "[steps('basics').imageMinorVersion]",
                "imagePatch": "[steps('basics').imagePatch]",
                "hyperVGeneration": "[steps('basics').hyperVGeneration]"
            }
        }
    }
}